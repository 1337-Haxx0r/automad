/*
 *	                  ....
 *	                .:   '':.
 *	                ::::     ':..
 *	                ::.         ''..
 *	     .:'.. ..':.:::'    . :.   '':.
 *	    :.   ''     ''     '. ::::.. ..:
 *	    ::::.        ..':.. .''':::::  .
 *	    :::::::..    '..::::  :. ::::  :
 *	    ::'':::::::.    ':::.'':.::::  :
 *	    :..   ''::::::....':     ''::  :
 *	    :::::.    ':::::   :     .. '' .
 *	 .''::::::::... ':::.''   ..''  :.''''.
 *	 :..:::'':::::  :::::...:''        :..:
 *	 ::::::. '::::  ::::::::  ..::        .
 *	 ::::::::.::::  ::::::::  :'':.::   .''
 *	 ::: '::::::::.' '':::::  :.' '':  :
 *	 :::   :::::::::..' ::::  ::...'   .
 *	 :::  .::::::::::   ::::  ::::  .:'
 *	  '::'  '':::::::   ::::  : ::  :
 *	            '::::   ::::  :''  .:
 *	             ::::   ::::    ..''
 *	             :::: ..:::: .:''
 *	               ''''  '''''
 *	
 *
 *	AUTOMAD
 *
 *	Copyright (c) 2016-2020 by Marc Anton Dahmen
 *	http://marcdahmen.de
 *
 *	Licensed under the MIT license.
 */


@am-md-transition-delay: 			       0.1s;
@am-md-selection-color:                    @base-selection-color;
@am-md-selection-background:               @base-selection-background;

@am-md-navbar-background:                  @form-border;

@am-md-navbar-nav-height:                  30px;
@am-md-navbar-nav-padding-horizontal:      12px;
@am-md-navbar-nav-line-height:             @am-md-navbar-nav-height;
@am-md-navbar-nav-color:                   @am-muted;

@am-md-navbar-nav-hover-background:        @am-md-navbar-background;
@am-md-navbar-nav-hover-color:             @button-color;
@am-md-navbar-nav-onclick-background:      @am-md-navbar-nav-hover-background;
@am-md-navbar-nav-onclick-color:           @am-md-navbar-nav-hover-color;
@am-md-navbar-nav-active-background:       @am-md-navbar-nav-hover-background;
@am-md-navbar-nav-active-color:            @am-md-navbar-nav-hover-color;
 
@am-md-content-border:                     @am-border-color;
@am-md-content-background:                 #FFFFFF;
@am-md-content-padding:                    20px;
@am-md-content-split-border:               @form-border;

@am-md-fullscreen-z-index:                 1040;
@am-md-fullscreen-content-top:             @am-md-navbar-nav-height;
@am-md-fullscreen-icon-resize:             "\f066";

@am-md-fullscreen-content-top:             0;


.uk-markdowneditor {
    border: none;
}

.uk-markdowneditor-navbar {
    
    box-sizing: border-box;
	overflow: hidden;
    padding: 2px 2px 0 2px;
	border-top-left-radius: @am-radius;
	border-top-right-radius: @am-radius;
	background: @am-md-navbar-background;
	
    // Hide preview button.
	&-flip li[class*="-button-"] {
		@media (max-width: @breakpoint-small-max) {
			display: none;
		}	
	}
}

.uk-markdowneditor-navbar:before,
.uk-markdowneditor-navbar:after {
    content: "";
    display: table;
}

.uk-markdowneditor-navbar:after { 
	clear: both; 
}

.uk-markdowneditor-navbar-nav {
    margin: 0;
    padding: 0;
    list-style: none;
    float: left;
}

.uk-markdowneditor-navbar-nav > li { 
	float: left; 
}

.uk-markdowneditor-navbar-nav > li > a {
    display: block;
    box-sizing: border-box;
    text-decoration: none;
    height: @am-md-navbar-nav-height;
    padding: 0 @am-md-navbar-nav-padding-horizontal;
    line-height: @am-md-navbar-nav-line-height;
    color: @am-md-navbar-nav-color;
    font-size: 11px;
    cursor: pointer;
	
	@media (min-width: 375px) {
        font-size: 12px;
    }

}

.uk-markdowneditor-navbar-nav > li:hover > a,
.uk-markdowneditor-navbar-nav > li > a:focus { 
    background-color: @am-md-navbar-nav-hover-background;
    color: @am-md-navbar-nav-hover-color;
    outline: none;     
}

.uk-markdowneditor-navbar-nav > li > a:active {
    background-color: @am-md-navbar-nav-onclick-background;
    color: @am-md-navbar-nav-onclick-color;
}

.uk-markdowneditor-navbar-nav > li.uk-active > a {
    background-color: @am-md-navbar-nav-active-background;
    color: @am-md-navbar-nav-active-color;
}

.uk-markdowneditor-navbar-flip { 
	float: right; 
}

[data-mode='split'] .uk-markdowneditor-button-code,
[data-mode='split'] .uk-markdowneditor-button-preview { 
	display: none; 
}

.uk-markdowneditor-content {
    border-left: 1px solid @am-md-content-border;
    border-right: 1px solid @am-md-content-border;
    border-bottom: 1px solid @am-md-content-border;
    border: none;
	background-color: transparent;
}

.uk-markdowneditor-content:before,
.uk-markdowneditor-content:after {
    content: "";
    display: table;
}

.uk-markdowneditor-content:after { 
	clear: both; 
}

.uk-markdowneditor-code,
.uk-markdowneditor-preview { 
	box-sizing: border-box; 
}

.uk-markdowneditor-code {
	
	& .CodeMirror {
		
		font-family: @base-code-font-family;
        font-size: @base-code-font-size;
		padding: @am-md-content-padding;
		color: @form-color;
		background-color: @form-background;
		border-bottom-left-radius: @am-radius;
		border-bottom-right-radius: @am-radius;
		border: @am-border-width solid @form-border;
		-moz-tab-size: 4;
		tab-size: 4;
		
        @media (max-width: @breakpoint-small-max) {
			padding: 10px;
		}
        
		&.CodeMirror-focused {
			color: @form-focus-color;
			background-color: @form-focus-background;
            border-color: @form-focus-border;
		}

		& .CodeMirror-line,
		& .CodeMirror-placeholder {
			font-weight: @base-body-font-weight;
		}

		& .CodeMirror-placeholder {
			color: @form-placeholder-color;
		}

		& .CodeMirror-scroll {
			box-sizing: border-box;
			overflow-x: hidden !important;
		}
		
		& .CodeMirror-sizer {
			margin: 0 !important;
		}

		// Delay transition to avoid flickering when clicken on any button in the CodeMirror navbar.
		&,
		& * {
			.transition(color 0.2s @am-md-transition-delay, background-color 0.2s @am-md-transition-delay, border-color 0.2s @am-md-transition-delay, box-shadow 0.2s @am-md-transition-delay;);
		}

	}
	
}

.uk-markdowneditor-preview {
	
	position: relative;
	overflow: hidden;
	padding: @am-md-content-padding;
	color: @form-focus-color;
	background-color: @form-background;
	border-bottom-left-radius: @am-radius;
	border-bottom-right-radius: @am-radius;
	border: @am-border-width solid @form-border;
    .markdown;
    
    & :first-child {
        margin-top: 0;
    }
    
}

.uk-markdowneditor-fullscreen {

	position: fixed;
	min-height: 100vh;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
	z-index: @am-md-fullscreen-z-index;
	
	& .uk-markdowneditor-navbar {
        
        position: fixed;
        z-index: 100;
        width: 288px;
        top: 15px;
        left: 50%;
        margin-left: -144px;
        padding: 0;
        border-radius: @am-radius;
        background-color: @button-background;
        .shadow;
        
        &-nav a {
            height: 36px;
            width: 36px;
            font-size: 14px;
            text-align: center;
            padding: 0;
            line-height: 36px;
            color: @button-color !important;
        }
        
        // Hide preview button.
        &-flip li[class*="-button-"] {
    		display: none;
    	}
        
    }

	& .uk-markdowneditor-content {
		position: absolute;
		top: @am-md-fullscreen-content-top;
		left: 0;
		right: 0;
		bottom: 0;
		background-color: @am-bg;
	}

	& .uk-icon-expand:before { 
		content: @am-md-fullscreen-icon-resize; 
	}    

    & .CodeMirror,
    & .uk-markdowneditor-preview  {
        border: none !important;
    }
 
    & .cm-s-default {
        padding: 0;
        border-radius: 0;
    }
    
	& .uk-markdowneditor-code .CodeMirror-scroll,
	& .uk-markdowneditor-preview {
		padding: @utility-container-padding-horizontal;
        padding-top: 70px;
		color: @form-focus-color;
		background-color: @am-bg;
        border-radius: 0;
		.transition(all 0s;);
	}
	
	&[data-mode='split'] .uk-markdowneditor-code {
		
		& .cm-s-default {
			border-right: none;
		}
        
	}
	
	& .uk-markdowneditor-preview {
		border-left: none;
	}
	
}

[data-mode='tab'][data-active-tab='code'] .uk-markdowneditor-preview,
[data-mode='tab'][data-active-tab='preview'] .uk-markdowneditor-code { display: none; }

[data-mode='split'] .uk-markdowneditor-code,
[data-mode='split'] .uk-markdowneditor-preview {
    float: left;
    width: 50%;
}

[data-mode='split'] .uk-markdowneditor-code { border-right: 1px solid @am-md-content-split-border; }

.uk-markdowneditor .CodeMirror {
    padding: 10px;
    box-sizing: border-box;
}

// Autoresize editor and preview.
:not(.uk-markdowneditor-fullscreen) > div {
	
	& > div > .CodeMirror,
	& > .uk-markdowneditor-preview {
	  	height: auto !important;
		min-height: @form-height;
	}

}

.CodeMirror-lines {
	padding: 0; // Vertical padding around content.
}

.CodeMirror pre {
	padding: 0; // Horizontal padding of content.
}

.CodeMirror-scrollbar-filler, .CodeMirror-gutter-filler {
	background-color: inherit; // The little square between H and V scrollbars.
}

.cm-s-default {
	
	font-weight: 400;
	
	& .cm-header {
		color: inherit;
	}

	& .cm-quote {
		color: inherit;
	}
	
	& .cm-keyword {
		color: inherit;
	}
	
	& .cm-atom {
		color: inherit;
	}
	
	& .cm-number {
		color: inherit;
	}
	
	& .cm-def {
		color: inherit;
	}
	
	& .cm-variable,
	& .cm-punctuation,
	& .cm-property,
	& .cm-operator {
		color: inherit;
	}
		
	& .cm-variable-2 {
		color: @am-success;
	}
	
	& .cm-variable-3 {
		color: inherit;
	}
	
	& .cm-comment {
		color: inherit;
	}
	
	& .cm-string {
		color: inherit;
		font-style: italic;
	}
	
	& .cm-string-2 {
		color: inherit;
	}
	
	& .cm-meta {
		color: inherit;
	}
	
	& .cm-qualifier {
		color: inherit;
	}
	
	& .cm-builtin {
		color: inherit;
	}
	
	& .cm-bracket {
		color: inherit;
	}
	
	& .cm-tag {
		color: inherit;
	}
	
	& .cm-attribute {
		color: inherit;
	}
	
	& .cm-hr {
		color: inherit;
	}
	
	& .cm-link {
		color: @am-success;
	}
    
    & .cm-url {
        color: @am-muted;
    }

	& .cm-error {
		color: inherit;
	}
	
    &.CodeMirror .CodeMirror-matchingbracket {
        color: @am-danger;
        font-weight: bold;
    }
    
    & .CodeMirror-selected,
    & .CodeMirror-selectedtext { 
        color: @am-md-selection-color;
        background-color: @am-md-selection-background; 
    }
    
    & .CodeMirror-line::selection, 
    & .CodeMirror-line > span::selection, 
    & .CodeMirror-line > span > span::selection { 
        color: @am-md-selection-color;
        background-color: @am-md-selection-background;
    }
    
    & .CodeMirror-line::-moz-selection, 
    & .CodeMirror-line > span::-moz-selection, 
    & .CodeMirror-line > span > span::-moz-selection { 
        color: @am-md-selection-color;
        background-color: @am-md-selection-background;
    }
    
}

.cm-negative {
	color: inherit;
}

.cm-header, 
.cm-strong {
	font-weight: bold;
}

.cm-em {
	font-style: italic;
}

.cm-link {
	text-decoration: none;
}

.cm-strikethrough {
	text-decoration: line-through;
}

.cm-invalidchar {
	color: inherit;
}

/*
 *	                  ....
 *	                .:   '':.
 *	                ::::     ':..
 *	                ::.         ''..
 *	     .:'.. ..':.:::'    . :.   '':.
 *	    :.   ''     ''     '. ::::.. ..:
 *	    ::::.        ..':.. .''':::::  .
 *	    :::::::..    '..::::  :. ::::  :
 *	    ::'':::::::.    ':::.'':.::::  :
 *	    :..   ''::::::....':     ''::  :
 *	    :::::.    ':::::   :     .. '' .
 *	 .''::::::::... ':::.''   ..''  :.''''.
 *	 :..:::'':::::  :::::...:''        :..:
 *	 ::::::. '::::  ::::::::  ..::        .
 *	 ::::::::.::::  ::::::::  :'':.::   .''
 *	 ::: '::::::::.' '':::::  :.' '':  :
 *	 :::   :::::::::..' ::::  ::...'   .
 *	 :::  .::::::::::   ::::  ::::  .:'
 *	  '::'  '':::::::   ::::  : ::  :
 *	            '::::   ::::  :''  .:
 *	             ::::   ::::    ..''
 *	             :::: ..:::: .:''
 *	               ''''  '''''
 *	
 *
 *	AUTOMAD GUI 
 *	
 *	version 17.01.22
 *
 *	Copyright (c) 2014-2017 by Marc Anton Dahmen
 *	http://marcdahmen.de
 *
 *	Licensed under the MIT license.
 *	http://automad.org/license
 */+function(t,a){t.addVariable={selectors:{container:"#am-add-variable-container",modal:"#am-add-variable-modal",modalInput:"#am-add-variable-input",submit:"#am-add-variable-submit"},dataAttr:{errorName:"data-am-error-name",errorExists:"data-am-error-exists"},append:function(e){var o=t.addVariable,n=t.util,i=a(e.target),r=a(o.selectors.container),d=a(o.selectors.modalInput),l="am-input-data-",s=d.val().replace(/[^\w\.\-]/g,"_").toLowerCase();0==a("#"+l+s).length?s?a.post("?ajax=add_variable",{name:s},function(t){UIkit.modal(o.selectors.modal).hide(),d.val(""),r.append(t),a("#"+l+s).focus()}):t.notify.error(i.data(n.dataCamelCase(o.dataAttr.errorName))):t.notify.error(i.data(n.dataCamelCase(o.dataAttr.errorExists)))}},a(document).on("click",t.addVariable.selectors.submit,t.addVariable.append)}(window.Automad=window.Automad||{},jQuery),+function(t,a){t.autocomplete={data:{},submitForm:function(t){t.preventDefault();var e=a(t.target).closest("form");setTimeout(function(){e.submit()},50)}},a.post("?ajax=autocomplete",function(a){
t.autocomplete.data=a},"json"),a(document).on("keydown",'.uk-autocomplete input[type="text"]',function(a){13==a.which&&t.autocomplete.submitForm(a)}),a(document).on("click",".uk-form .uk-dropdown a",t.autocomplete.submitForm)}(window.Automad=window.Automad||{},jQuery),+function(t,a){t.count={dataAttr:"data-am-count",get:function(e){var o=t.count;a("["+o.dataAttr+"]").each(function(){var e=a(this),n=e.data(t.util.dataCamelCase(o.dataAttr));e.text(a(n).length)})},init:function(){var e=t.count,o=a(document);o.on("ready ajaxComplete",e.get)}},t.count.init()}(window.Automad=window.Automad||{},jQuery),+function(t,a){t.editFileInfo={dataAttr:{fileInfo:"data-am-file-info",url:"data-am-url",ext:"data-am-extension"},selectors:{modal:"#am-edit-file-info-modal",button:"#am-edit-file-info-submit",img:"#am-edit-file-info-img",icon:"#am-edit-file-info-icon",oldName:"#am-edit-file-info-old-name",newName:"#am-edit-file-info-new-name",caption:"#am-edit-file-info-caption",download:"#am-edit-file-info-download"
},destroy:function(){var e=t.editFileInfo,o=e.dataAttr,n=e.selectors;a(n.img).attr("src","").removeAttr("width").removeAttr("height"),a(n.icon).attr(o.ext,""),a(n.download).attr("href",""),a(n.oldName).val(""),a(n.newName).val(""),a(n.caption).val("").trigger("keyup")},init:function(){var e=t.editFileInfo,o=t.util,n=e.dataAttr,i=e.selectors,r=a(this).closest("["+n.fileInfo+"]"),d=r.data(o.dataCamelCase(n.fileInfo)),l=a(i.modal);d.img?a(i.img).attr("src",d.img.src).attr("width",d.img.width).attr("height",d.img.height):a(i.icon).attr(n.ext,d.extension),a(i.oldName).val(d.filename),a(i.newName).val(d.filename),a(i.caption).val(d.caption).trigger("keyup"),a(i.download).attr("href",d.download),l.off("hide.uk.modal.automad.editFileInfo"),l.on("hide.uk.modal.automad.editFileInfo",e.destroy)},submit:function(e){var o=t.editFileInfo,n=o.selectors,i=a(e.target),r={url:a(n.modal).data(t.util.dataCamelCase(o.dataAttr.url)),"old-name":a(n.oldName).val(),"new-name":a(n.newName).val(),caption:a(n.caption).val()
};i.prop("disabled",!0),a.post("?ajax=edit_file_info",r,function(e){i.prop("disabled",!1),e.error&&t.notify.error(e.error),a(n.modal).on("hide.uk.modal.automad.editFileInfo",function(){o.destroy(),a(n.modal).closest("form").empty().submit()}),UIkit.modal(n.modal).hide()},"json")}},a(document).on("click",'a[href="'+t.editFileInfo.selectors.modal+'"]',t.editFileInfo.init),a(document).on("click",t.editFileInfo.selectors.button,t.editFileInfo.submit)}(window.Automad=window.Automad||{},jQuery),+function(t,a){t.form={unsavedClassPrefix:"am-unsaved-",dataAttr:{handler:"data-am-handler",url:"data-am-url",submit:"data-am-submit",init:"data-am-init",autoSubmit:"data-am-auto-submit",close:"data-am-close-on-success",confirm:"data-am-confirm",enter:"data-am-enter",defaultValue:"data-am-default",watchExclude:"data-am-watch-exclude"},ajaxPost:function(e){var o=t.form,n=o.dataAttr,i=a(e.target),r=i.data(t.util.dataCamelCase(o.dataAttr.handler)),d=i.data(t.util.dataCamelCase(o.dataAttr.url));i.find("["+n.defaultValue+"]").each(function(){
var e=a(this);e.val()||e.val(e.data(t.util.dataCamelCase(n.defaultValue)))});var l=i.serializeArray();d&&l.push({name:"url",value:d}),a.post("?ajax="+r,l,function(a){if(a.debug&&console.log(a.debug),a.redirect&&(window.location.href=a.redirect),a.html&&i.html(a.html),a.error&&t.notify.error(a.error),a.success&&t.notify.success(a.success),!a.error){var e=i.data(t.util.dataCamelCase(o.dataAttr.close));e&&UIkit.modal(e).hide()}},"json")},confirm:function(e){e.preventDefault();var o=t.form,n=a(e.target),i=n.data(t.util.dataCamelCase(o.dataAttr.confirm));i&&n.find("input").length>0?UIkit.modal.confirm(i,function(){o.ajaxPost(e)}):o.ajaxPost(e)},init:function(){var e=a(document),o=t.form,n=o.dataAttr;e.on("submit","["+n.handler+"]",o.confirm),e.on("click","["+n.submit+"]",function(e){var o=a(this).data(t.util.dataCamelCase(n.submit));e.preventDefault(),a("form["+n.handler+'="'+o+'"]').submit()}),e.ready(function(){a("["+t.form.dataAttr.init+"]").trigger("submit")}),e.on("keydown","["+n.handler+"] input",function(t){
13==t.which&&t.preventDefault()}),e.on("keydown","["+n.enter+"]",function(e){if(13==e.which){var o=a(e.target).data(t.util.dataCamelCase(n.enter));a(o).click()}}),e.on("change drop cut paste","["+n.autoSubmit+"] input, ["+n.autoSubmit+"] textarea, ["+n.autoSubmit+"] select",function(t){a(t.target).closest("form").submit()}),e.on("ready",function(){a("button["+n.submit+"]").prop("disabled",!0)}),e.on("ajaxComplete",function(t,e,o){var i=o.url.replace("?ajax=","");a("button["+n.submit+'="'+i+'"]').prop("disabled",!0)}),e.on("change drop cut paste keydown","["+n.handler+"]:not(["+n.autoSubmit+"]) input:not(["+n.watchExclude+"]), ["+n.handler+"]:not(["+n.autoSubmit+"]) textarea:not(["+n.watchExclude+"]), ["+n.handler+"]:not(["+n.autoSubmit+"]) select:not(["+n.watchExclude+"])",function(){var e=a(this).closest("["+n.handler+"]"),i=e.data(t.util.dataCamelCase(n.handler));a("html").addClass(o.unsavedClassPrefix+i),a("button["+n.submit+'="'+i+'"]:disabled').prop("disabled",!1)}),e.on("submit","["+n.handler+"]",function(){
var e=a(this).data(t.util.dataCamelCase(n.handler));a("html").removeClass(o.unsavedClassPrefix+e)}),window.onbeforeunload=function(){return a('html[class*="am-unsaved-"]').length?"You have unsaved chages!":void 0},e.on("ready ajaxComplete",o.modalEvents),e.on("ready ajaxComplete",o.placeholderEvents),e.on("ready ajaxComplete",function(){setTimeout(function(){a(".CodeMirror:not(.am-change-event)").each(function(){var t=a(this),e=t[0].CodeMirror,o=t.prev();t.addClass("am-change-event"),e.on("change",function(){o.trigger("change")})})},500)})},modalEvents:function(){var e=a(".uk-modal");e.off("show.uk.modal.automad.form"),e.off("hide.uk.modal.automad.form"),e.on({"show.uk.modal.automad.form":function(){a(this).find("["+t.form.dataAttr.init+"]").each(function(){a(this).empty().submit()}),a(this).find('input:not(:disabled, [type="hidden"])').first().focus()},"hide.uk.modal.automad.form":function(){a(this).find("form").each(function(){var e=a(this).data(t.util.dataCamelCase(t.form.dataAttr.handler));
a("html").removeClass(t.form.unsavedClassPrefix+e),this.reset()})}})},placeholderEvents:function(){var t=a("input, textarea");t.off("focus.automad.form.placeholder"),t.off("blur.automad.form.placeholder"),t.on({"focus.automad.form.placeholder":function(){a(this).data("placeholder",a(this).attr("placeholder")).attr("placeholder","")},"blur.automad.form.placeholder":function(){a(this).attr("placeholder",a(this).data("placeholder"))}})}},t.form.init()}(window.Automad=window.Automad||{},jQuery),+function(t){t(document).ready(function(){t("#am-no-js").remove()})}(jQuery),+function(t,a){t.notify={error:function(t){UIkit.notify(t,{timeout:1e4,pos:"top-right",status:"danger"})},success:function(t){UIkit.notify(t,{timeout:3e3,pos:"top-right",status:"success"})}}}(window.Automad=window.Automad||{},jQuery),+function(t){t(document).on("click",".am-remove-parent",function(){var a=t(this).parent();a.find("input, textarea").trigger("change"),a.remove()})}(jQuery),+function(t,a){t.scrollbars={$scrolledElements:a(),
scrolledClass:"am-scrolled",defaults:{scrollToItem:!1},dataAttr:"data-am-scroll-box",init:function(){var e=t.scrollbars,o=t.util;a("["+e.dataAttr+"]").each(function(){var t=a(this),n=t.data(o.dataCamelCase(e.dataAttr)),i=a.extend({},e.defaults,n);if(t.mCustomScrollbar({scrollbarPosition:"inside",theme:"minimal-dark",autoHideScrollbar:!0,scrollInertia:50,scrollButtons:{enable:!1},callbacks:{onScroll:function(){t.trigger("scrolled.automad")},onUpdate:function(){t.trigger("scrolled.automad")}}}),i.scrollToItem){var r=t.find(i.scrollToItem);r.length&&setTimeout(function(){r.offset().top+180>a(window).height()&&t.mCustomScrollbar("scrollTo",function(){return r.offset().top-a(window).height()+180},{scrollInertia:200})},150)}}),a(window).scroll(function(){this.scrolling&&clearTimeout(this.scrolling),this.scrolling=setTimeout(function(){a(this).trigger("scrolled.automad")},50)}),a(window).on("load scrolled.automad",e.scrolled)},scrolled:function(e){var o=t.scrollbars,n=a(e.target),i=0;"undefined"!=typeof n[0].mcs?n.height()>100&&(i=Math.abs(n[0].mcs.top)):(i=Math.abs(parseInt(a("html").css("margin-top"))),
0==i&&(i=n.scrollTop())),i>20?o.$scrolledElements=o.$scrolledElements.add(n):o.$scrolledElements=o.$scrolledElements.not(n),o.$scrolledElements.length>0?a("html").addClass(o.scrolledClass):a("html").removeClass(o.scrolledClass)}},a(document).ready(t.scrollbars.init)}(window.Automad=window.Automad||{},jQuery),+function(t,a){t.sidebar={dataAttr:"data-am-toggle-sidebar",classActive:"uk-active",toggle:function(e){e.preventDefault();var o=t.sidebar,n=a(this).data(t.util.dataCamelCase(o.dataAttr)),i=a(n);i.hasClass(o.classActive)?UIkit.offcanvas.hide(!1):UIkit.offcanvas.show(n)},init:function(){var e=t.sidebar,o=a("["+e.dataAttr+"]");o.on("click",e.toggle),a(".uk-offcanvas").on({"hide.uk.offcanvas":function(){o.find("i").addClass("uk-icon-navicon").removeClass("uk-icon-close")},"show.uk.offcanvas":function(){o.find("i").removeClass("uk-icon-navicon").addClass("uk-icon-close")}})}},a(document).on("ready",t.sidebar.init)}(window.Automad=window.Automad||{},jQuery),+function(t,a){t.siteTree={"class":{
active:"uk-active",iconOpen:"am-tree-icon-open",iconClose:"am-tree-icon-close",toggle:"am-tree-toggle"},dataAttr:"data-am-tree",urlAsValue:function(e,o){var n=t.siteTree,i=e.find('a[href^="?"]'),r=e.find("."+n["class"].active+' > a[href^="?"]');r.length>0&&o.val(decodeURIComponent(r.attr("href").split("=")[1])),i.click(function(t){t.preventDefault();var i=a(this),r=i.parent(),d=decodeURIComponent(i.attr("href").split("=")[1]);e.find("."+n["class"].active).removeClass(n["class"].active),r.addClass(n["class"].active),r.find("> a").has("."+n["class"].iconOpen).click(),o.val(d).trigger("change")})},init:function(){var e=t.siteTree,o=a("["+e.dataAttr+"]");o.each(function(){var o=a(this),n=o.data(t.util.dataCamelCase(e.dataAttr));o.find("li li").has("li").each(function(){var t=a(this),o=t.children("ul"),n=a("<a></a>",{"class":e["class"].toggle,href:"#"}).prependTo(t),i=a("<i></i>").prependTo(n);t.hasClass(e["class"].active)||t.find("."+e["class"].active).length>0?i.addClass(e["class"].iconClose):(i.addClass(e["class"].iconOpen),
o.hide()),n.click(function(t){t.preventDefault(),o.toggle(),i.toggleClass(e["class"].iconOpen+" "+e["class"].iconClose)})}),n.length>0&&e.urlAsValue(o,a(n))})}},a(document).ready(t.siteTree.init)}(window.Automad=window.Automad||{},jQuery),+function(t,a){t.status={dataAttr:"data-am-status",get:function(){var e=t.status;a("["+e.dataAttr+"]").each(function(){var o=a(this),n=o.data(t.util.dataCamelCase(e.dataAttr));a.post("?ajax=status",{item:n},function(t){o.html(t.status)},"json")})},init:function(){var e=a(document),o=t.status;e.ready(function(){o.get()}),e.ajaxComplete(function(t,a,e){"?ajax=status"!=e.url&&o.get()})}},t.status.init()}(window.Automad=window.Automad||{},jQuery),+function(t,a){t.switcher={getActiveTab:function(){var t=0;return window.location.hash&&(t=parseInt(window.location.hash.substring(1))),t}},UIkit.on("beforeready.uk.dom",function(){a.extend(UIkit.components.switcher.prototype.defaults,{active:t.switcher.getActiveTab()})}),a(document).on("ready",function(){a("[data-uk-switcher]").on("show.uk.switcher",function(t,a){
window.location.hash=a.index()})})}(window.Automad=window.Automad||{},jQuery),+function(t,a){t.textarea={selector:"textarea.uk-form-controls:not([data-uk-htmleditor])",handleTabs:function(t){if(9===t.keyCode){t.preventDefault();var e=this.selectionStart,o=this.selectionEnd,n=a(t.target),i=n.val();n.val(i.substring(0,e)+"	"+i.substring(o)),this.selectionStart=this.selectionEnd=e+1}},init:function(){var e=t.textarea,o=a(document);o.on("keyup focus focusout update.automad.textarea",e.selector,e.resize),o.on("drop cut paste",e.selector,function(t){var e=a(t.target);setTimeout(function(t){e.trigger("update.automad.textarea")},50)}),o.ajaxComplete(function(){a(e.selector).trigger("update.automad.textarea")}),o.on("click","[data-uk-toggle]",function(){a(e.selector).trigger("update.automad.textarea")}),a(window).resize(function(){a(e.selector).trigger("update.automad.textarea")}),o.on("keydown",e.selector,e.handleTabs)},resize:function(t){var e=a(t.target),o=e.val().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br />"),n=a("<div></div>").appendTo("body").hide().width(e.width()).html(o+" ").css({
"white-space":"pre-wrap","word-wrap":"break-word","overflow-wrap":"break-word","font-family":e.css("font-family"),"font-size":e.css("font-size"),"line-height":e.css("line-height"),"letter-spacing":e.css("letter-spacing")});e.height(n.height()),n.remove()}},t.textarea.init(),UIkit.on("beforeready.uk.dom",function(){a.extend(UIkit.components.htmleditor.prototype.defaults,{height:250})})}(window.Automad=window.Automad||{},jQuery),+function(t,a){t.toggle={labelDataAttr:"data-am-toggle","class":{active:"uk-active",toggleContainer:"am-toggle-container"},checkbox:function(e){t.toggle.update(a(e.target))},init:function(){a("["+t.toggle.labelDataAttr+"] input").each(function(){t.toggle.update(a(this))})},radio:function(e){a('input[name="'+a(e.target).attr("name")+'"]').each(function(){t.toggle.update(a(this))})},update:function(e){var o=t.toggle,n=e.parent(),i=n.data(t.util.dataCamelCase(o.labelDataAttr));if(e.is(":checked")?n.addClass(o["class"].active):n.removeClass(o["class"].active),i){var r=a(i).addClass(o["class"].toggleContainer);
e.is(":checked")?r.addClass(o["class"].active):r.removeClass(o["class"].active)}}},a(document).on("change","["+t.toggle.labelDataAttr+'] [type="checkbox"]',t.toggle.checkbox),a(document).on("change","["+t.toggle.labelDataAttr+'] [type="radio"]',t.toggle.radio),a(document).on("ready ajaxComplete",t.toggle.init)}(window.Automad=window.Automad||{},jQuery),+function(t,a){t.upload={dataAttr:{url:"data-am-url",dropzoneText:"data-am-dropzone-text",browseText:"data-am-browse-text"},selectors:{modal:"#am-upload-modal",container:"#am-upload-container"},$modal:"",$container:"",$close:"",page:"",$dropzone:a("<div></div>",{"class":"am-files-dropzone"}),$input:a('<input type="file" multiple />'),$browse:a("<button></button>",{"class":"uk-button uk-button-primary uk-width-1-1 uk-margin-top"}).click(function(){return t.upload.$input.click(),!1}),init:function(e){var o=t.upload;o.$modal=a(o.selectors.modal),o.$container=a(o.selectors.container).empty(),o.page=o.$modal.data(t.util.dataCamelCase(o.dataAttr.url)),
o.$dropzone.text(o.$modal.data(t.util.dataCamelCase(o.dataAttr.dropzoneText))).appendTo(o.$container),o.$input.appendTo(o.$dropzone).hide(),o.$browse.text(o.$modal.data(t.util.dataCamelCase(o.dataAttr.browseText))).insertAfter(o.$dropzone),o.$close=o.$modal.find(".uk-modal-close"),o.plugin(),a(o.selectors.modal).on("hide.uk.modal",{$filesForm:o.$modal.closest("form")},o.refresh)},plugin:function(){var e=t.upload;e.$input.fileupload({url:"?ajax=upload",dataType:"json",dropZone:e.$dropzone,sequentialUploads:!0,singleFileUploads:!0,formData:[{name:"url",value:e.page}],add:function(o,n){var i="";a.each(n.files,function(a){i+='<div class="am-text-white uk-margin-small-bottom uk-text-truncate"><span class="uk-badge">'+t.util.formatBytes(n.files[a].size)+"</span>&nbsp;&nbsp;"+n.files[a].name+"</div>"}),n.context=a("<div></div>",{"class":"uk-margin-large-top"}).appendTo(e.$container),a(i).appendTo(n.context),a('<div class="uk-progress uk-progress-striped uk-active"><div class="uk-progress-bar"></div></div>').appendTo(n.context),
n.context.find(".uk-progress-bar").width("0px"),n.submit(),e.$close.prop("disabled",!0),e.$close.find("i").removeClass("uk-icon-close").addClass("uk-icon-circle-o-notch uk-icon-spin")},progress:function(t,a){var e=parseInt(a.loaded/a.total*100,10);a.context.find(".uk-progress-bar").text(e+" %").width(e+"%")},stop:function(t){e.$close.prop("disabled",!1),e.$close.find("i").addClass("uk-icon-close").removeClass("uk-icon-circle-o-notch uk-icon-spin")},done:function(t,a){a.context.find(".uk-progress").removeClass("uk-progress-striped uk-active"),a.result.error?a.context.find(".uk-progress").addClass("uk-progress-danger").find(".uk-progress-bar").text(a.result.error):a.context.find(".uk-progress").addClass("uk-progress-success")},fail:function(t,a){a.context.find(".uk-progress").addClass("uk-progress-danger"),a.context.find(".uk-progress-bar").text("Error")}})},refresh:function(t){t.data.$filesForm.empty().submit()}},a(document).on("click",'[href="'+t.upload.selectors.modal+'"]',t.upload.init),
a(document).on("drop dragover",t.upload.selectors.modal,function(t){t.preventDefault()})}(window.Automad=window.Automad||{},jQuery),+function(t,a){t.util={dataCamelCase:function(t){return t=t.replace(/data-/g,""),t=t.replace(/\-[a-z]/g,function(t){return t.charAt(1).toUpperCase()})},formatBytes:function(t){return"number"!=typeof t?"":t>=1e9?(t/1e9).toFixed(2)+" gb":t>=1e6?(t/1e6).toFixed(2)+" mb":(t/1e3).toFixed(2)+" kb"}}}(window.Automad=window.Automad||{},jQuery);